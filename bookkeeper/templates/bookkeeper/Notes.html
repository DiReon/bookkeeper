
Archive for {{ month|date:"F" }} {{ month.year }}<br />
<div class="pagination pull-left">
    <ul>
        {% if previous_month %}
            <li class="prev">
                <a href="{% url %}?year={{ previous_month|date:"Y"  }}&month={{ previous_month|date:"b" }}">
                    &larr; {{ previous_month|date:"M Y" }}
                </a>
            </li>
        {% endif %}
        {% if next_month %}
            <li class="next">
                <a href="{% url %}?year={{ next_month|date:"Y"  }}&month={{ next_month|date:"b" }}">
                    {{ next_month|date:"M Y" }} &rarr;</a>
            </li>
        {% endif %}
    </ul>
</div>


class SummaryListView(generic.ListView):
    template_name = "bookkeeper/summary_list.html"
    model = Expense
#    queryset = Expense.objects.order_by("-payment_date")
    paginate_by = 30
    cat = None

    def get(self, request, *args, **kwargs):
        if self.kwargs["cat_id"] == None: self.cat = Category.objects.first()
        else: self.cat = Category.objects.get(pk = self.kwargs["cat_id"])
        return super(SummaryListView, self).get(request, *args, **kwargs)

    def get_context_data(self, **kwargs):
        context = super(SummaryListView, self).get_context_data(**kwargs)
        context["cats"] = Category.objects.order_by("name")
        context["category"] = self.cat
        return context
    def queryset(self):
        return Expense.objects.filter(category = self.cat).order_by("name")


        if request.method == 'POST':
        form = ExpenseForm(request.POST)
        if form.is_valid():
            expense = form.save(commit=False)
            expense.author = request.user
            expense.save()
            return redirect('expense_list')
    else:
        form = ExpenseForm()
    return render(request, 'bookkeeper/expense_list.html', {'expenses': expenses, 'form': form})
